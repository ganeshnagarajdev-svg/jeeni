<div class="min-h-screen bg-surface-50">
  
  <!-- Header / Breadcrumb area -->
  <div class="bg-white shadow-sm border-b border-secondary-200">
    <div class="container mx-auto px-4 py-6">
      <h1 class="text-3xl font-display font-bold text-secondary-900">Shop</h1>
      <p class="text-secondary-500 mt-1">Discover premium collections curated for you.</p>
    </div>
  </div>

  <div class="container mx-auto px-4 py-8">
    <div class="flex flex-col lg:flex-row gap-8">
      
      <!-- Filters Sidebar -->
      <div class="lg:w-1/4">
        <div class="card p-6 sticky top-24">
          <div class="flex justify-between items-center mb-6">
            <h2 class="text-lg font-bold">Filters</h2>
            <button (click)="clearFilters()" class="text-sm text-primary-600 hover:text-primary-700">Reset</button>
          </div>

          <!-- Categories -->
          <div class="mb-8">
            <h3 class="text-sm font-semibold text-secondary-900 uppercase tracking-wider mb-4">Categories</h3>
            <div class="space-y-2">
              <label *ngFor="let category of categories" class="flex items-center group cursor-pointer">
                <input type="radio" name="category" [value]="category.id" 
                  [checked]="selectedCategoryId === category.id"
                  (change)="onCategoryChange(category.id)"
                  class="w-4 h-4 text-primary-600 border-gray-300 focus:ring-primary-500">
                <span class="ml-3 text-secondary-600 group-hover:text-primary-600 transition-colors">{{ category.name }}</span>
              </label>
            </div>
          </div>

          <!-- Price Range -->
          <div>
            <h3 class="text-sm font-semibold text-secondary-900 uppercase tracking-wider mb-4">Price Range</h3>
            <div class="space-y-4">
               <div class="flex items-center gap-4">
                 <input type="number" [(ngModel)]="minPrice" placeholder="Min" class="input-field py-2 text-sm">
                 <span class="text-secondary-400">-</span>
                 <input type="number" [(ngModel)]="maxPrice" placeholder="Max" class="input-field py-2 text-sm">
               </div>
               <button (click)="applyFilters()" class="w-full btn-secondary text-sm py-2">Apply</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Product Grid -->
      <div class="lg:w-3/4">
        
        <!-- Controls -->
        <div class="flex justify-between items-center mb-6">
          <p class="text-secondary-500 text-sm">Showing <span class="font-bold text-secondary-900">{{ products.length }}</span> results</p>
          <div class="flex items-center gap-2">
            <label class="text-sm text-secondary-500">Sort by:</label>
            <select class="input-field py-1 pl-3 pr-8 text-sm" (change)="onSortChange($event)">
              <option value="newest">Newest</option>
              <option value="price_low">Price: Low to High</option>
              <option value="price_high">Price: High to Low</option>
            </select>
          </div>
        </div>

        <!-- Loading State -->
        <div *ngIf="isLoading" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
           <div *ngFor="let i of [1,2,3,4,5,6]" class="card h-96 animate-pulse">
             <div class="bg-secondary-200 h-48 w-full"></div>
             <div class="p-4 space-y-3">
               <div class="h-4 bg-secondary-200 rounded w-3/4"></div>
               <div class="h-4 bg-secondary-200 rounded w-1/2"></div>
             </div>
           </div>
        </div>

        <!-- Products -->
        <div *ngIf="!isLoading && products.length > 0" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
          <div *ngFor="let product of products" class="card group overflow-hidden flex flex-col">
            <div class="relative overflow-hidden aspect-w-4 aspect-h-3">
               <img [src]="product.images?.[0]?.image_url || 'assets/placeholder.jpg'" 
                    [alt]="product.name" 
                    class="object-cover w-full h-full transform group-hover:scale-110 transition-transform duration-500">
               
               <!-- Hover Actions -->
               <div class="absolute inset-0 bg-black/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center gap-3">
                 <button (click)="viewDetails(product.slug)" class="bg-white text-secondary-900 p-2 rounded-full hover:bg-primary-500 hover:text-white transition-colors shadow-lg" title="View Details">
                   <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" /></svg>
                 </button>
               </div>
            </div>
            
            <div class="p-4 flex-grow flex flex-col">
              <div class="mb-2">
                <span class="text-xs font-semibold tracking-wider text-primary-600 uppercase bg-primary-50 px-2 py-1 rounded-md">{{ product.category_id }}</span>
              </div>
              <h3 class="text-lg font-bold text-secondary-900 mb-1 group-hover:text-primary-600 transition-colors">{{ product.name }}</h3>
              <p class="text-secondary-500 text-sm line-clamp-2 mb-4 flex-grow">{{ product.description }}</p>
              
              <div class="flex items-center justify-between pt-4 border-t border-secondary-100 mt-auto">
                <span class="text-xl font-bold text-secondary-900">â‚¹{{ product.price }}</span>
                <button (click)="buyNow(product)" class="text-sm font-medium text-primary-600 hover:text-primary-700 hover:underline">Buy Now &rarr;</button>
              </div>
            </div>
          </div>
        </div>

        <div *ngIf="!isLoading && products.length === 0" class="text-center py-12 bg-white rounded-xl shadow-sm border border-secondary-200">
          <p class="text-lg text-secondary-500">No products found matching your criteria.</p>
          <button (click)="clearFilters()" class="mt-4 btn-primary">Clear Filters</button>
        </div>

      </div>
    </div>
  </div>
</div>
